# Standards: 1.0.0
---

# 5.3.3 Ensure password reuse is limited

- name: 5.3.3 - Ensure password reuse is limited
  replace:
      path: "{{ item }}"
      regexp: '^password    sufficient    pam_unix.so try_first_pass use_authtok nullok sha512 shadow'
      replace: 'password    sufficient    pam_unix.so remember=5 try_first_pass use_authtok nullok sha512 shadow'
  with_items:
    - /etc/pam.d/system-auth
    - /etc/pam.d/password-auth
  tags:
    - level-1
    - section-5
    - section-5.3
    - section-5.3.3
    - "5.3.3"
    - scored

- name: 5.3.3 - Ensure password reuse is limited
  replace:
      path: "{{ item }}"
      regexp: '^password    required      pam_deny.so'
      replace: 'password    required      pam_pwhistory.so remember=5'
  with_items:
    - /etc/pam.d/system-auth
    - /etc/pam.d/password-auth
  tags:
    - level-1
    - section-5
    - section-5.3
    - section-5.3.3
    - "5.3.3"
    - scored